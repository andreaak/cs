<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Работа с HTML формой</title>
    <script src="/03_Javascript/17_Events/03_IE_Events/002_CrossBrowserEventUtil.js"></script>
    <script>
        window.onload = function () {

            var textbox = document.forms[0].elements["textbox1"];
            alert(textbox.value);
            textbox.value = "Some new value";

            var textbox = document.forms[0].elements["textbox1"];
            textbox.select();

            EventUtil.addHandler(textbox, "focus", function (event) {
                event = EventUtil.getEvent(event);
                var target = EventUtil.getTarget(event);
                target.select();
            });

            var textbox = document.forms[0].elements["textbox1"];
            EventUtil.addHandler(textbox, "select", function (event) {
                alert("Text selected: " + textbox.value);
            });

            function getSelectedText(textbox) {
                return textbox.value.substring(textbox.selectionStart,
                textbox.selectionEnd);
            }

            function getSelectedText(textbox) {
                if (typeof textbox.selectionStart == "number") {
                    return textbox.value.substring(textbox.selectionStart,
                            textbox.selectionEnd);
                }
                else if (document.selection) {
                    return document.selection.createRange().text;
                }
            }

            textbox.value = "Hello world!";

            //выделение всего текста
            textbox.setSelectionRange(0, textbox.value.length);//"Hello world!"

            //выделение трех первых символов
            textbox.setSelectionRange(0, 3);//"Hel"

            //выделение символов с 4 по 6
            textbox.setSelectionRange(4, 7);//"о w"
            

            textbox.value = "Hello world!";
            var raпge = textbox.createTextRange();

            //выделение всего текста
            range.collapse(true);
            range.moveStart("character", 0);
            range.moveEnd("character", textbox.value.length);//"Hello world!"
            range.select();


            //выделение первых трех символов
            raпge.collapse(true);
            raпge.moveStart("character", 0);
            raпge.moveEnd("character", 3);
            range.select();//"Hel"

            //выделение символов с 4 по 6
            range.collapse(true);
            range.moveStart("character", 4);
            range.moveEnd("character", 3);
            range.select();//"о w"
            

            function selectText(textbox, startIndex, stopIndex) {
                if (textbox.setSelectionRange) {
                    textbox.setSelectionRange(startIndex, stopIndex);
                } else if (textbox.createTextRange) {
                    var range = textbox.createTextRange();
                    range.collapse(true);
                    range.moveStart("character", startIndex);
                    raпge.moveEnd("character", stopIndex - startIndex);
                    raпge.select();
                }

                textbox.focus();
            }

            textbox.value = "Hello world!";
            //выделение всего текста
            selectText(textbox, 0, textbox.value.length);//"Hello world!"

            //выделение первых трех символов
            selectText(textbox, 0, З);//"Hel"

            //выделение символов с 4 по 6
            selectText(textbox, 4, 7);//"оw"

        }
    </script>
</head>
<body>

    <input type="text" size="25" maxlength="50" value="initial value">

    <textarea rows="25" cols="5">initial value</textarea>

</body>
</html>
