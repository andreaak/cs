<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Замыкание или closures</title>
</head>
<body>
    <script>
        function init() {
            var str = "Hello World";

            function displayStr() {
                // вложенная функция имеет доступ к переменной str
                document.writeln(str + "</br>");
            }

            displayStr();
        }
        init();

        function makeFunc() {
            var str = "Hello world";
            function displayStr() {
                document.writeln(str);
            }
            // функция возвращается но не запускается.
            return displayStr;
        }

        /* 
        Замыкание - функция, в которой находятся переменные объявленные 
        в не тела этой функции.
        Замыкание - это функция и окружение, в которой была создана функция.
        */
        var myFunc = makeFunc();
        myFunc();

        function createComparisonFunction(propertyName) {

            return function (object1, object2) {
                var value1 = object1[propertyName];
                var value2 = object2[propertyName];
                if (value1 < value2) {
                    return -1;
                } else if (value1 > value2) {
                    return 1;
                } else {
                    return 0;
                }
            };
        }

        function compare(value1, value2) {
            if (value1 < value2) {
                return -1;
            } else if (value1 > value2) {
                return 1;

            } else {
                return 0;
            }
        }
        var result = compare(5, 10);

        var compare = createComparisonFunction("пame");
        var result = compare({ name: "Nicholas" }, { name: "Greg" });

        //создание функции
        var compareNames = createComparisonFunction("name");
        //вызов функции
        var result = compareNames({ name: "Nicholas" }, { name: "Greg" });
        //завершение работы с функцией - теперь память может быть возвращена среде
        compareNames = null;

    </script>
</body>
</html>
